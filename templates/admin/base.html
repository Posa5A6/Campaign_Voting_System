{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Admin Panel{% endblock %}</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body class="admin-body">

<div class="admin-shell">

  <!-- SIDEBAR -->
  <aside class="admin-sidebar" id="adminSidebar">
    <div class="admin-brand">
      <div class="brand-icon">üó≥Ô∏è</div>
      <div class="brand-text">
        <div class="brand-title">Campaign Voting</div>
        <div class="brand-sub">Admin Console</div>
      </div>
    </div>

    <nav class="admin-nav">
      <a href="{% url 'admin_dashboard' %}" class="admin-link {% block nav_dashboard %}{% endblock %}">
        <i class="bi bi-speedometer2"></i>
        <span>Dashboard</span>
      </a>

      <a href="{% url 'admin_campaigns' %}" class="admin-link {% block nav_campaigns %}{% endblock %}">
        <i class="bi bi-kanban"></i>
        <span>Campaigns</span>
      </a>

      <a class="admin-link {% if request.resolver_match.url_name == 'create_campaign' %}active{% endif %}"
         href="{% url 'create_campaign' %}">
        <i class="bi bi-plus-circle"></i>
        <span>Create Campaign</span>
      </a>
      
      <div class="admin-nav-divider"></div>

      <a href="{% url 'admin_logout' %}" class="admin-link danger-link">
        <i class="bi bi-box-arrow-right"></i>
        <span>Logout</span>
      </a>
    </nav>

    <div class="admin-userbox">
      <div class="user-avatar">
        <i class="bi bi-person-fill"></i>
      </div>
      <div class="user-meta">
        <div class="user-name">{{ request.user.username }}</div>
        <div class="user-role">Administrator</div>
      </div>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="admin-main">

    <!-- TOPBAR -->
    <header class="admin-topbar">
      <div class="topbar-left">
        <button class="btn admin-burger d-lg-none" id="sidebarToggle" type="button" aria-label="Toggle Sidebar">
          <i class="bi bi-list"></i>
        </button>

        <div class="topbar-title">
          <div class="h5 fw-bold mb-0">{% block page_title %}Admin{% endblock %}</div>
          <div class="text-secondary small">{% block page_subtitle %}{% endblock %}</div>
        </div>
      </div>

      <div class="topbar-actions">
        {% block top_actions %}{% endblock %}
      </div>
    </header>

    <!-- CONTENT -->
    <section class="admin-content container-fluid">
      {% block content %}{% endblock %}
    </section>

    <!-- FOOTER -->
    <footer class="admin-footer">
      <span>¬© {{ now|default:"" }} Campaign Voting Admin</span>
      <span class="text-secondary">Secure ‚Ä¢ Fast ‚Ä¢ Verified</span>
    </footer>

  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Sidebar toggle (mobile)
  document.addEventListener("DOMContentLoaded", () => {
    const sidebar = document.getElementById("adminSidebar");
    const toggle = document.getElementById("sidebarToggle");

    toggle?.addEventListener("click", () => {
      sidebar.classList.toggle("open");
    });

    // close sidebar when clicking outside (mobile)
    document.addEventListener("click", (e) => {
      if (!sidebar) return;
      if (window.innerWidth > 992) return;
      const clickedInside = sidebar.contains(e.target) || toggle.contains(e.target);
      if (!clickedInside) sidebar.classList.remove("open");
    });
  });
</script>

</body>
</html>
